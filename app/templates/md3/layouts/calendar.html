{% extends 'base.html' %}

{% block head %}
<!-- MD3 Token und Kalender-spezifische Styles -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/m3-tokens.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/md3-calendar.css') }}">
<!-- CSS-Überschreibungen für Kompatibilität mit base.html/Bulma -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/md3-calendar-override.css') }}">
<!-- MD3 Kalender-Events Styling -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/md3-calendar-events.css') }}">

<!-- Kritische Inline-Styles mit höchster Spezifität -->
<style>
  /* Grundlegende Container-Reset für Kalender-Sektion */
  html body .md3-calendar-section.section,
  html body section.md3-calendar-section {
    padding: 0 !important;
    margin: 0 !important;
    display: block !important;
    width: 100% !important;
  }
  
  html body .md3-calendar-container-override.container,
  html body .container.md3-calendar-container-override {
    width: 100% !important;
    max-width: 100% !important;
    padding: 1rem !important;
    margin: 0 !important;
    display: block !important;
  }
  
  /* Extremes Grid-Layout-Override */
  html body .md3-calendar-grid,
  #calendar-grid-force {
    display: grid !important;
    grid-template-columns: repeat(7, 1fr) !important;
    gap: 4px !important;
    margin: 1rem auto !important;
    width: 100% !important;
    max-width: 1200px !important;
  }
  
  /* Debug-Grid zur Verifikation mit höchster Spezifität */
  #debug-grid-verification {
    display: grid !important;
    grid-template-columns: repeat(7, 1fr) !important;
    gap: 4px !important;
    margin: 1rem auto !important;
    padding: 10px !important;
    border: 2px solid #ff6b6b !important;
    background-color: #fff5f5 !important;
    border-radius: 8px !important;
  }
  
  #debug-grid-verification > div {
    padding: 10px !important;
    text-align: center !important;
    background-color: #e9ecef !important;
    border-radius: 4px !important;
  }
</style>
    z-index: 1;
  }
  
  /* Bulma-Überschreibungen (kritisch für Grid-Layout) */
  body .section.md3-calendar-section {
    padding: 0 !important;
    margin: 0 !important;
    min-height: auto !important;
  }
  
  body .container.md3-calendar-container-override {
    max-width: 100% !important;
    width: 100% !important;
    padding: 1rem !important; /* Ein wenig Padding für besseres Aussehen */
    margin: 0 !important;
  }
  
  /* Explizite Regeln für Grid-Layout */
  body .md3-calendar-grid {
    display: grid !important;
    grid-template-columns: repeat(7, 1fr) !important;
    gap: 4px !important;
    margin: 0 auto !important;
    max-width: 1200px !important;
    background-color: var(--md-sys-color-surface-container, #f1f1f1) !important;
    border: 1px solid var(--md-sys-color-outline-variant, #e0e0e0) !important;
    border-radius: 16px !important;
    overflow: hidden !important;
  }
  
  body .md3-calendar-grid .md3-calendar-weekday,
  body .md3-calendar-grid .md3-calendar-day {
    padding: 8px !important;
    text-align: center !important;
    box-sizing: border-box !important;
    min-height: 48px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
  }
  
  body .md3-calendar-grid .md3-calendar-weekday {
    font-weight: 500 !important;
    color: var(--md-sys-color-on-surface-variant, #666) !important;
    background-color: var(--md-sys-color-surface-container-high, #e7e7e7) !important;
  }
  
  body .md3-calendar-grid .md3-calendar-day {
    position: relative !important;
    color: var(--md-sys-color-on-surface, #111) !important;
    cursor: pointer !important;
    transition: background-color 0.2s ease !important;
  }
  
  body .md3-calendar-grid .md3-calendar-day:hover {
    background-color: var(--md-sys-color-surface-container-highest, #f5f5f5) !important;
  }
  
  body .md3-calendar-grid .md3-calendar-day.today {
    color: var(--md-sys-color-primary, #6750a4) !important;
    font-weight: 700 !important;
  }
  
  /* Verhindert, dass Bulma-Klassen die MD3-Stile überschreiben */
  body .md3-calendar-wrapper .md3-calendar-header,
  body .md3-calendar-wrapper .md3-calendar-title,
  body .md3-calendar-wrapper .md3-calendar-actions {
    all: revert !important;
    font-family: 'Roboto', sans-serif !important;
    box-sizing: border-box !important;
  }
  
  body .md3-calendar-wrapper .md3-calendar-header {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    padding: 16px !important;
    margin-bottom: 16px !important;
  }
  
  body .md3-calendar-wrapper .md3-calendar-title {
    font-size: 24px !important;
    font-weight: 500 !important;
    color: var(--md-sys-color-on-surface, #1f1f1f) !important;
    margin: 0 !important;
  }

  /* Debug-Grid (zur Verifizierung) */
  #debug-grid-verification {
    display: grid !important;
    grid-template-columns: repeat(7, 1fr) !important;
    gap: 2px !important;
    border: 2px solid #ff5722 !important;
    margin: 10px auto !important;
    padding: 4px !important;
    max-width: 600px !important;
  }
  
  #debug-grid-verification > div {
    background-color: #e3f2fd !important;
    border: 1px solid #2196f3 !important;
    padding: 8px !important;
    text-align: center !important;
  }
</style>
{% endblock %}

{% block content %}
<!-- Override der Bulma-Sektionen mit spezifischen CSS-Klassen -->
<section class="section md3-calendar-section">
  <div class="container md3-calendar-container-override">
    <header class="md-nav-container">
      {% include 'md3-nav.html' %}
    </header>

    <div class="md3-calendar-wrapper" style="width: 100% !important; max-width: 1200px !important; margin: 0 auto !important;">
      
      <!-- MD3 Kalender mit selektiven CSS-Überschreibungen -->
      <div class="md3-calendar">
        <div class="md3-calendar-header" style="display: flex !important; justify-content: space-between !important; align-items: center !important; margin-bottom: 1rem !important; padding: 8px 16px !important;">
          <div class="md3-calendar-title" style="font-size: 20px !important; font-weight: 500 !important; color: var(--md-sys-color-on-surface, #1d1b16) !important;">Juli 2025</div>
          <div class="md3-calendar-actions" style="display: flex !important; gap: 8px !important;">
            <button id="prev-month-btn" class="md3-calendar-prev" style="border: none !important; background-color: var(--md-sys-color-surface-container-high, #ece6f0) !important; color: var(--md-sys-color-on-surface, #1d1b16) !important; border-radius: 20px !important; width: 40px !important; height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important; box-shadow: var(--md-sys-elevation-1, 0 1px 2px rgba(0,0,0,0.3)) !important;">
              <span class="material-symbols-outlined">chevron_left</span>
            </button>
            <button id="today-btn" class="md3-calendar-today" style="border: none !important; background-color: var(--md-sys-color-primary-container, #e8ddff) !important; color: var(--md-sys-color-on-primary-container, #22005d) !important; border-radius: 20px !important; padding: 0 16px !important; height: 40px !important; font-weight: 500 !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important; box-shadow: var(--md-sys-elevation-1, 0 1px 2px rgba(0,0,0,0.3)) !important;">Heute</button>
            <button id="next-month-btn" class="md3-calendar-next" style="border: none !important; background-color: var(--md-sys-color-surface-container-high, #ece6f0) !important; color: var(--md-sys-color-on-surface, #1d1b16) !important; border-radius: 20px !important; width: 40px !important; height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important; box-shadow: var(--md-sys-elevation-1, 0 1px 2px rgba(0,0,0,0.3)) !important;">
              <span class="material-symbols-outlined">chevron_right</span>
            </button>
          </div>
        </div>
        
        <div class="md3-calendar-grid" id="calendar-grid-force" style="display: grid !important; grid-template-columns: repeat(7, 1fr) !important; gap: 4px !important; margin: 1rem auto !important; width: 100% !important; max-width: 1200px !important;">
          <!-- Wochentage -->
          <div class="md3-calendar-weekday" style="padding: 8px !important; text-align: center !important; font-weight: 500 !important; background-color: var(--md-sys-color-surface-container-high, #e7e7e7) !important; border-radius: 4px !important;">MO</div>
          <div class="md3-calendar-weekday" style="padding: 8px !important; text-align: center !important; font-weight: 500 !important; background-color: var(--md-sys-color-surface-container-high, #e7e7e7) !important; border-radius: 4px !important;">DI</div>
          <div class="md3-calendar-weekday" style="padding: 8px !important; text-align: center !important; font-weight: 500 !important; background-color: var(--md-sys-color-surface-container-high, #e7e7e7) !important; border-radius: 4px !important;">MI</div>
          <div class="md3-calendar-weekday" style="padding: 8px !important; text-align: center !important; font-weight: 500 !important; background-color: var(--md-sys-color-surface-container-high, #e7e7e7) !important; border-radius: 4px !important;">DO</div>
          <div class="md3-calendar-weekday" style="padding: 8px !important; text-align: center !important; font-weight: 500 !important; background-color: var(--md-sys-color-surface-container-high, #e7e7e7) !important; border-radius: 4px !important;">FR</div>
          <div class="md3-calendar-weekday" style="padding: 8px !important; text-align: center !important; font-weight: 500 !important; background-color: var(--md-sys-color-surface-container-high, #e7e7e7) !important; border-radius: 4px !important;">SA</div>
          <div class="md3-calendar-weekday" style="padding: 8px !important; text-align: center !important; font-weight: 500 !important; background-color: var(--md-sys-color-surface-container-high, #e7e7e7) !important; border-radius: 4px !important;">SO</div>
          
          <!-- Tage des Monats -->
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">1</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">2</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">3</div>
          <div class="md3-calendar-day today" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important; color: var(--md-sys-color-primary, #6750a4) !important; font-weight: 700 !important; border: 1px solid var(--md-sys-color-primary, #6750a4) !important;">4</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">5</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">6</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">7</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">8</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">9</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">10</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">11</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">12</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">13</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">14</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">15</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">16</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">17</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">18</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">19</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">20</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">21</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">22</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">23</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">24</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">25</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">26</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">27</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">28</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">29</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">30</div>
          <div class="md3-calendar-day" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important;">31</div>
          <div class="md3-calendar-day other-month" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important; color: var(--md-sys-color-outline, #79747e) !important; opacity: 0.6 !important;">1</div>
          <div class="md3-calendar-day other-month" style="padding: 8px !important; text-align: center !important; border-radius: 4px !important; min-height: 40px !important; display: flex !important; align-items: center !important; justify-content: center !important; cursor: pointer !important; color: var(--md-sys-color-outline, #79747e) !important; opacity: 0.6 !important;">2</div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block scripts %}
<!-- Kalender-spezifische Skripte -->
<script src="{{ url_for('static', filename='js/md3-calendar.js') }}"></script>
<!-- Kalender-Events und Benachrichtigungen -->
<script src="{{ url_for('static', filename='js/md3-calendar-events.js') }}"></script>

<!-- Ripple-Effekt CSS -->
<style>
  .ripple {
    position: absolute;
    border-radius: 50%;
    transform: scale(0);
    background-color: rgba(255, 255, 255, 0.3);
    pointer-events: none;
    animation: ripple-animation 0.6s linear;
  }
  
  .md3-calendar-prev .ripple,
  .md3-calendar-next .ripple {
    background-color: rgba(0, 0, 0, 0.1);
  }
  
  @keyframes ripple-animation {
    to {
      transform: scale(2);
      opacity: 0;
    }
  }
  
  /* Tastaturzugänglichkeit */
  .md3-calendar-day:focus {
    outline: 2px solid var(--md-sys-color-primary, #6750a4);
    outline-offset: 2px;
    position: relative;
    z-index: 1;
  }
</style>
{% endblock %}
